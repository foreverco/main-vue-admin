<template>
  <div class="mainPage">
    <div class="layout_top">
      <div class="layout_top_left">
        <div>
          <BaseTitle moduleTitle="设备在线情况" />
          <div class="equipment_online">
            <EquipmentCard />
          </div>
        </div>
        <div class="monitor">
          <div class="monitor_left">
            <BaseTitle moduleTitle="环境监控" />
            <div class="huanjing_monitor">
              <div>
                <Player class="large_video" />
              </div>
              <div>
                <EquipmentMsg />
              </div>
            </div>
          </div>
          <div class="monitor_right">
            <BaseTitle moduleTitle="视频监控" />
            <div class="video_monitor">
              <Player class="small_video bottom" />
              <Player class="small_video bottom" />
              <Player class="small_video" />
              <Player class="small_video" />
            </div>
          </div>
        </div>
      </div>
      <div class="layout_top_right">
        <BaseTitle moduleTitle="今日天气" />
        <Weather />
      </div>
    </div>
    <div class="layout_bottom">
      <div class="layout_bottom_left">
        <BaseTitle moduleTitle="设备采集趋势">
          <el-form slot="right" class="option_deveice_type">
            <SensorPicker
              :sensorPickerLevel="['largeArea', 'areas']"
              :sensorData="sensorData"
              :config="config"
              v-on:update:sensorData="sensorData = $event"
            ></SensorPicker>
            <!-- {{ sensorData }} -->
          </el-form>
        </BaseTitle>
        <div class="device_acquisition_trend">
          <DeviceAcquisitionTrend :areasValue="sensorData.areasValue" />
        </div>
      </div>
      <div class="layout_bottom_right">
        <BaseTitle moduleTitle="今日告警信息">
          <div slot="right" class="warning_count">
            <span>告警数量</span>
            <i class="iconfont iconyujing1"></i>
            <span v-on:update:total="warningTotal = $event" class="total">
              {{ warningTotal }}
            </span>
          </div>
        </BaseTitle>
        <div class="warning">
          <WarningList :total.sync="warningTotal" ref="warning_list" />
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import BaseTitle from "../../components/common/BaseTitle.vue";
import EquipmentCard from "./components/EquipmentCard.vue";
import EquipmentMsg from "./components/EquipmentMsg.vue";
import Player from "../../components/common/video.vue";
import Echars from "../../components/echarts/Echars.vue";
import DeviceAcquisitionTrend from "./components/DeviceAcquisitionTrend.vue";
import SensorPicker from "../../components/SensorPicker/index";
import Weather from "./components/TodayWeather";
import WarningList from "./components/WarningList.vue";
import {
  ref,
  reactive,
  onMounted,
  onBeforeMount,
  computed,
  watch
} from "@vue/composition-api";
export default {
  name: "home",
  setup(props, { refs, root }) {
    const config = reactive({
      init: 7
    });
    const sensorData = reactive({});
    const weather = computed(() => root.$store.state.home.weather);
    const warningTotal = ref(0);
    const deveice = ref("deveice");
    onMounted(() => {
      console.log(refs.warning_list);
      console.log(warningTotal);
      console.log(refs.warning_list.warningTotal);
    });
    watch(warningTotal, (newval, oldval) => {
      console.log("=============");
      console.log(warningTotal);
    });
    return {
      weather,
      config,
      deveice,
      sensorData,
      warningTotal
    };
  },
  components: {
    BaseTitle,
    EquipmentCard,
    EquipmentMsg,
    Player,
    Weather,
    Echars,
    DeviceAcquisitionTrend,
    SensorPicker,
    WarningList
  }
};
</script>
<style lang="scss">
@import "@/styles/homeselect.scss";
</style>
<style lang="scss" scoped>
@import "@/styles/reset.scss";
.mainPage {
  // width: rem(1640);
  width: 100%;
  // border: 1px solid red;
}
.layout_top,
.layout_bottom {
  // border: 1px solid green;
  width: 100%;
  display: flex;
  justify-content: space-between;
}
.layout_bottom {
  margin: rem(30) 0;
}

.layout_top_left {
  width: 75.8%;
}
.layout_top_right {
  width: 22.3%;
}

/**设备在线情况 */
.equipment_online {
  margin-top: rem(16);
  // border: 1px solid red;
}
/*监控开始*/
.monitor {
  // border: 1px solid blue;
  margin-top: rem(26);
  display: flex;
  justify-content: space-between;
}
.monitor_left {
  width: 43.7%;
  // border: 1px solid blue;
}
.huanjing_monitor {
  margin-top: rem(20);
  // border: 1px solid red;
}
.huanjing_monitor > div:nth-child(1) {
  margin: 0 auto;
  width: rem(544);
}
.large_video {
  height: rem(305);
  text-align: center;
}
.huanjing_monitor > div:nth-child(2) {
  // border: 1px solid red;
  // height: 7vh;
  z-index: 10;
}
.monitor_right {
  width: 53%;
}
.video_monitor {
  // background: red;
  margin-top: rem(20);
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-content: flex-start;
}
.small_video {
  width: rem(317);
  height: rem(178);
}
.bottom {
  margin-bottom: rem(29);
}
/*设备采集趋势*/
.layout_bottom_left {
  width: 66%;
  margin-right: 1.7%;
}
.device_acquisition_trend {
  // width: 57vw;
  width: 100%;
  height: rem(403);
  margin-top: 1.48vh;
  position: relative;
  background: rgba(255, 255, 255, 1);
}

/*今日告警信息*/
.layout_bottom_right {
  width: 31.5%;
  .warning_count {
    float: right;
    margin-right: rem(6);
    line-height: $titleHeight;
    span:nth-child(1) {
      font-size: rem(11);
    }
    .total {
      font-size: rem(13);
    }
    .iconyujing1 {
      color: #ca1c29;
      margin-left: rem(17);
      margin-right: rem(2);
      font-size: rem(14);
    }
  }
}
.warning {
  margin-top: rem(15);
  overflow: auto;
}
</style>
