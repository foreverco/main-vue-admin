<template>
  <div>
    <BaseTitle moduleTitle="设备类别统计">
      <span slot="right" class="option"
        >类别选择
        <Select
          :config="configOption"
          :selectData="selectValue"
          v-on:update:selectData="selectValue = $event"
        />
        <!-- {{ selectValue }} -->
      </span>
    </BaseTitle>
    <ul class="deveice_area">
      <li v-for="(item, index) in option" :key="index">
        <Echars :option="option[index]"></Echars>
      </li>
    </ul>
  </div>
</template>
<script>
import BaseTitle from "../../../../components/common/BaseTitle.vue";
import Select from "../../../../components/Select/index.vue";
import Echars from "../../../../components/echarts/echarts_monitoring.vue";
import {
  deveiceTypeStatistics,
  reqDeviceType
} from "../../../../api/monitoring.js";
import { getChartOption } from "../../../../utils/mapUtil.js";
export default {
  components: {
    BaseTitle,
    Select,
    Echars
  },
  beforeMount() {
    // this.dealDeveiceTypeData();
  },
  mounted() {
    this.dealDeveiceTypeData();
    this.getChartData();
    // console.log(this.$store.state.map.areaList);
  },
  data() {
    return {
      // 图表配置项
      selectValue: "a01001",
      option: [],
      option1: [
        {
          title: "大标题",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [13, 26, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题2",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [55, 20, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题3",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [13, 26, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题4",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [55, 20, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题5",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [13, 26, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题6",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [55, 20, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题7",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [13, 26, 27, 35, 21, 21, 25]
        },
        {
          title: "大标题8",
          x: ["0:00", "4:00", "8:00", "12:00", "16:00", "20:00", "24:00"], // x轴
          data: [13, 26, 27, 35, 21, 21, 25]
        }
      ],
      configOption: {
        // init: ["a01007", "name", "phone", "a01001"]
        init: []
      }
    };
  },
  watch: {
    selectValue: function(val) {
      console.log(val);
      this.getChartData();
    }
  },
  methods: {
    getChartData() {
      // let data = "a01001";
      let data = this.selectValue;
      // console.log(data);
      // 调用曲线图数据
      deveiceTypeStatistics(data).then(res => {
        let deveice = res.data.data;
        this.option = getChartOption(deveice, 1);
        console.log(this.option);
      });
    },
    dealDeveiceTypeData() {
      reqDeviceType()
        .then(res => {
          // console.log(res.data.data);
          res.data.data.forEach(item => {
            let init = {};
            init.value = item.value;
            init.label = item.name;
            this.configOption.init.push(init);
          });
          // console.log(this.configOption.init);
        })
        .catch(error => {});
    }
  }
};
</script>
<style lang="scss" scoped>
@import "@/styles/reset.scss";
.option {
  float: right;
  margin-right: 2%;
}
.deveice_area {
  width: 100%;
  height: auto;
  display: flex;
  display: -webkit-flex;
  flex-direction: row;
  flex-wrap: wrap;
}

.deveice_area li {
  margin: 1%;
  width: 23%;
  height: 250px;
  border-radius: 8px;
  background: #ededed;
}
</style>
